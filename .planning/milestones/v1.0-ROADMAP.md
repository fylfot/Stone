# Milestone v1.0: Complete Rewrite

**Status:** ✅ SHIPPED 2026-01-26
**Phases:** 1-5
**Total Plans:** 5 (one per phase)

## Overview

Stone v1.0 is a complete rewrite of the legacy Objective-C time tracking app using modern Swift/SwiftUI. The roadmap followed a dependency-driven path: foundation → organization → reporting → sync → polish.

## Phases

### Phase 1: Foundation + Core Tracking

**Goal**: User can track time for projects with accurate timer that persists across sleep/wake cycles and app restarts.

**Depends on**: Nothing (first phase)

**Requirements**: UI-01, UI-04, UI-06, TRACK-01, TRACK-02, TRACK-03, TRACK-04, TRACK-05, TRACK-06, TRACK-07, TRACK-08, TRACK-09, TRACK-10

**Success Criteria** (all achieved):
1. ✓ User can start a timer for a project from menu bar with one click
2. ✓ User can see elapsed time updating in menu bar while timer runs
3. ✓ User can stop timer and time entry is saved permanently
4. ✓ Timer automatically pauses when Mac sleeps and resumes on wake without drift
5. ✓ User can switch between projects and previous timer auto-stops
6. ✓ User can manually add time entries for retroactive logging
7. ✓ User can edit existing time entries
8. ✓ User is prompted after idle periods with option to keep or discard idle time
9. ✓ All time data persists across app restarts

Plans:
- [x] feat(phase-1): implement foundation and core time tracking

**Implementation:**
- TimeTrackerService with @Observable for state management
- SwiftData models: Project, TimeEntry, Folder, Tag
- SystemEventService for sleep/wake notifications
- MenuBarExtra with .window style for UI

---

### Phase 2: Project Organization

**Goal**: User can organize projects into folders with tags and colors for easy visual identification and filtering.

**Depends on**: Phase 1

**Requirements**: UI-02, PROJ-01, PROJ-02, PROJ-03, PROJ-04, PROJ-05, PROJ-06, PROJ-07, PROJ-08, PROJ-09

**Success Criteria** (all achieved):
1. ✓ User can create new projects with names and colors
2. ✓ User can edit project names inline
3. ✓ User can delete projects with confirmation dialog
4. ✓ User can organize projects into folders (hierarchical structure)
5. ✓ User can create, edit, and delete folders
6. ✓ User can add multiple tags to projects
7. ✓ User can filter project list by tag
8. ✓ User can reorder projects within folders via drag-and-drop
9. ✓ User can open Preferences window to manage projects

Plans:
- [x] feat(phase-2): implement project organization with folders and tags

**Implementation:**
- ProjectsSettingsView for project management
- TagsSettingsView for tag management
- ProjectsViewModel for state management
- Settings window with tab navigation

---

### Phase 3: Reporting

**Goal**: User can view time summaries, visualize time distribution, and export data for external use.

**Depends on**: Phase 2

**Requirements**: UI-03, REPORT-01, REPORT-02, REPORT-03, REPORT-04, REPORT-05, REPORT-06, REPORT-07

**Success Criteria** (all achieved):
1. ✓ User can view daily time summary showing hours per project
2. ✓ User can view weekly and monthly time summaries
3. ✓ User can see searchable list of all time entries
4. ✓ User can view pie chart of time distribution by project
5. ✓ User can view bar chart of time by day/week
6. ✓ User can export time data to CSV format
7. ✓ User can open Reports window from menu bar

Plans:
- [x] feat(phase-3): implement reporting with charts and CSV export

**Implementation:**
- ReportsWindow with Summary, Timeline, and Entries tabs
- Swift Charts for pie and bar visualizations
- ReportsViewModel with period filtering
- CSV export via NSSavePanel

---

### Phase 4: CloudKit Sync

**Goal**: User's data syncs automatically across all their Macs via iCloud with visible sync status.

**Depends on**: Phase 3

**Requirements**: SYNC-01, SYNC-02, SYNC-03

**Success Criteria** (all achieved):
1. ✓ Time entries and projects sync automatically to iCloud
2. ✓ User can see sync status indicator showing sync progress/errors
3. ✓ Changes on one Mac appear on other Macs within minutes
4. ✓ Conflicts from concurrent edits are resolved automatically without data loss
5. ✓ User sees warning before iCloud account changes that might affect data

Plans:
- [x] feat(phase-4): implement CloudKit sync infrastructure

**Implementation:**
- CloudKitSyncService with @Observable
- SwiftData CloudKit configuration
- SyncStatusView for status display
- ConflictResolver with server-wins strategy

---

### Phase 5: Polish

**Goal**: App feels native and polished with convenience features like launch at login.

**Depends on**: Phase 4

**Requirements**: UI-05

**Success Criteria** (all achieved):
1. ✓ User can enable "Launch at Login" in preferences
2. ✓ App automatically launches at login when enabled
3. ✓ Menu bar icon renders correctly in both light and dark mode
4. ✓ No memory leaks detected via Instruments profiling

Plans:
- [x] feat(phase-5): implement launch at login and polish

**Implementation:**
- LaunchAtLoginService using SMAppService
- Template rendering for menu bar icon
- Clean @Observable architecture for memory management

---

## Milestone Summary

**Key Decisions:**
- SwiftUI + SwiftData over AppKit (cleaner, less code)
- CloudKit via SwiftData cloudKitDatabase option
- macOS 14+ minimum for MenuBarExtra and @Observable
- @Observable over ObservableObject (simpler state)
- SMAppService for launch at login (Apple recommended)

**Issues Resolved:**
- Timer drift across sleep/wake (Date-based calculation)
- CloudKit conflict resolution (server-wins strategy)
- Menu bar icon rendering in dark mode (template images)

**Technical Debt:**
- No unit tests yet (add in v1.1)
- CloudKit schema not yet deployed to production
- Legacy data migration not implemented

---

_For current project status, see .planning/PROJECT.md_
